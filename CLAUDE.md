# KJ法アシストツール - 開発ガイドライン

## プロジェクト概要

### 📋 プロジェクトの立ち位置
このツールは、**議事録と改善提案シートの分析・整理を自動化**するKJ法支援ツールです。

#### 🔄 ワークフロー
1. **📄 文書アップロード**: 議事録・改善提案シートをテキスト形式で入力
2. **🔪 チャンク化**: AIが文書内容をKJ法用のカード（意見・提案単位）に分割
3. **🎯 KJ法View**: カードを視覚的に配置・操作できるキャンバス表示
4. **🤖 AIクラスタリング**: AIが関連性の高いカードをグループ化・分類
5. **✏️ 人間による編集**: AIの結果を確認・修正・調整
6. **📊 レポートView**: 整理結果を構造化された表形式で表示・出力

### 🏗️ データ構造
- **KJ法View** と **レポートView** は **1:1対応**
- 同一データを異なるGUIで表現（視覚的操作 vs 構造化表示）
- リアルタイム同期により、どちらで編集しても即座に反映

---

## 🎯 現在の機能

### 📱 インターフェース
- **タブ式ビュー切り替え**: KJ法 ⇔ レポート
- **固定操作パネル**: 右側320px幅の詳細パネル（KJ法Viewのみ）
- **ヘッダー操作**: 処理系ボタン（自動整理、ズーム、undo/redo）

### 🔧 核心機能
- **文書取り込み**: 議事録・改善提案シート別アップロード
- **AIチャンク化**: 文書を意見単位でカード分割
- **AIクラスタリング**: 課題-解決策の関係性分析とグループ化
- **視覚的編集**: ドラッグ&ドロップによるカード・グループ操作
- **履歴管理**: Undo/Redo機能（Cmd+Z対応）
- **データ永続化**: localStorage自動保存

---

## 🚀 開発ルール

### 📝 コミット戦略
**機能実装は必ず2段階コミット**で行う：

#### 1️⃣ 実装前コミット
```bash
git commit -m "Start implementing [機能名]: [概要説明]

Planning to implement:
- [実装予定の詳細1]
- [実装予定の詳細2] 
- [実装予定の詳細3]

🚧 Implementation in progress
"
```

#### 2️⃣ 実装後コミット
```bash
git commit -m "Complete [機能名] implementation

Implemented features:
- [実装完了した機能1]
- [実装完了した機能2]
- [実装完了した機能3]

Technical changes:
- [技術的変更点1]
- [技術的変更点2]

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
"
```

### 🎯 機能分類
新機能リクエストは以下のカテゴリで分類：

#### 📄 **文書処理系**
- アップロード機能の改善
- チャンク化精度向上
- 文書形式対応拡張

#### 🎨 **KJ法View系** 
- キャンバス操作の改善
- カード・グループ機能拡張
- 視覚的表現の改良

#### 🤖 **AI処理系**
- クラスタリング精度向上
- 分類ロジック改善
- AI処理オプション追加

#### 📊 **レポートView系**
- 表示形式の改良
- エクスポート機能
- データ可視化強化

#### 🔧 **基盤系**
- パフォーマンス改善
- データ構造変更
- UI/UX全般改善

---

## 📚 文言・用語統一

### 🎯 コア概念
- **カード**: 議事録・提案シートから抽出された個別の意見・提案
- **グループ**: 関連性の高いカードの集合（AIまたは手動でクラスタリング）
- **チャンク化**: 文書を意見単位のカードに分割する処理
- **クラスタリング**: カードを関連性に基づいてグループ化する処理

### 🖥️ UI要素
- **KJ法View**: ドラッグ&ドロップ可能なキャンバス表示
- **レポートView**: 構造化された表形式表示
- **操作パネル**: 右側固定の詳細パネル（文書アップロード、統計等）
- **ヘッダー**: 上部固定のナビゲーション・操作エリア

### 📝 ボタン・アクション
- **議事録を追加**: 会議ディスカッション文書のアップロード
- **改善提案シートを追加**: 改善提案文書のアップロード  
- **自動整理**: AIによるカードクラスタリング実行
- **元に戻す/やり直し**: 履歴管理操作

---

## 🧭 開発方針

### ✅ 必須確認事項
新機能実装前に必ず確認：

1. **📋 機能分類**: どのカテゴリの機能か？
2. **🎯 影響範囲**: KJ法View、レポートView、基盤のどこに影響？
3. **📐 データ構造**: 既存のカード・グループ構造に変更が必要か？
4. **🔄 同期要件**: View間のデータ同期に影響があるか？
5. **🚀 パフォーマンス**: 大量データでの動作に問題ないか？

### 🎨 UI/UX原則
- **一貫性**: 両Viewで同一データの表現を統一
- **応答性**: ユーザー操作に対する即座のフィードバック
- **直感性**: 機能配置と操作フローの論理的整合性
- **安定性**: キャンバス操作時のUI要素の固定性

---

## 🔍 現在の技術スタック

### 📦 主要ライブラリ
- **React 18**: フロントエンドフレームワーク
- **react-dnd**: ドラッグ&ドロップ機能
- **Tailwind CSS**: スタイリング
- **localStorage API**: データ永続化

### 🏗️ アーキテクチャ
- **コンポーネント設計**: 機能別分離（Canvas, TableView, DetailPanel等）
- **状態管理**: React Hooks（useState, useEffect, useCallback）
- **データフロー**: Props drilling + カスタムHooks
- **レイアウト**: CSS Grid + Flexbox + Absolute positioning

---

## 📋 次回実装時の注意点

1. **📝 事前コミット**を忘れずに実行
2. **🎯 機能分類**を明確化してから実装開始
3. **🔄 両View**への影響を事前検討
4. **✅ 段階的テスト**でデグレード防止
5. **📚 文言統一**の維持

---

*最終更新: 2025年6月12日*
*バージョン: v3.12*